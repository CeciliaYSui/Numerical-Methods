% Adaptive Simpson's Method function [result] = Simpson (f,a,b,epsilon,level,level_max)  level = level + 1;   h = b - a;   c = (a + b) / 2;   one_simpson = h * (f(a) + 4*f(c) + f(b)) / 6;   d = (a + c) / 2;   e = (c + b) / 2;   two_simpson = h * (f(a) + 4*f(d) + 2*f(c) + 4*f(e) + f(b)) / 12;   if level >= level_max    result = two_simpson;     disp("maximum level reached");   else     if abs(two_simpson - one_simpson) < 15 * epsilon       result = two_simpson + (two_simpson - one_simpson)/15;     else       left_simpson = Simpson(f,a,c,epsilon/2, level, level_max);       right_simpson = Simpson(f,c,b,epsilon/2, level, level_max);       result = left_simpson + right_simpson;     endif  endif
endfunction
